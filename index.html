<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>🎉 多语言幸运转盘 - DeFi 挖矿</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Rubik:wght@400;700&display=swap');

  /* 全局样式 */
  body {
    margin: 0; padding: 40px 20px 80px;
    min-height: 100vh;
    background:
      radial-gradient(circle at center, #005d40, #012f20 80%),
      linear-gradient(45deg, #004e2e, #002110);
    font-family: 'Rubik', sans-serif;
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    overflow-x: hidden;
    user-select: none;
  }
  h1 {
    font-weight: 700;
    font-size: 2.4rem;
    margin-bottom: 6px;
    text-shadow: 0 0 6px #009d77;
  }
  p.subtitle {
    font-size: 1.2rem;
    margin-bottom: 24px;
    opacity: 0.85;
    text-shadow: 0 0 3px #004433;
  }

  /* 语言选择下拉框 */
  #langSelect {
    position: fixed;
    top: 16px;
    right: 16px;
    padding: 8px 14px;
    font-size: 1rem;
    border-radius: 8px;
    border: none;
    background-color: #009d77;
    color: white;
    cursor: pointer;
    z-index: 9999;
    transition: background-color 0.3s ease;
  }
  #langSelect:hover {
    background-color: #007955;
  }

  /* 转盘容器 */
  .wheel-container {
    position: relative;
    width: 480px; height: 480px;
    box-shadow:
      0 0 15px #00bfa5,
      inset 0 0 30px #00bfa5;
    border-radius: 50%;
    background: radial-gradient(circle, #004d3d 0%, #00322a 90%);
    user-select: none;
  }

  canvas#wheelcanvas {
    border-radius: 50%;
    display: block;
    margin: auto;
  }

  /* 彩灯环 */
  .lights-ring {
    position: absolute;
    top: -15px; left: -15px;
    width: 510px; height: 510px;
    border-radius: 50%;
    pointer-events: none;
    box-shadow:
      0 0 15px #00ffd8,
      0 0 30px #00ffd8,
      0 0 50px #00ffd8,
      0 0 80px #00ffe0;
    animation: pulseLights 3s infinite alternate;
    z-index: 5;
  }
  @keyframes pulseLights {
    0% {
      box-shadow:
        0 0 12px #00f0d5,
        0 0 24px #00f0d5,
        0 0 40px #00f7df,
        0 0 60px #00ffe5;
    }
    100% {
      box-shadow:
        0 0 20px #00ffe5,
        0 0 40px #00ffe5,
        0 0 60px #00f7df,
        0 0 80px #00f0d5;
    }
  }

  /* 指针：向内指向转盘中心 */
  #pointer {
    position: absolute;
    top: 30px;
    left: 50%;
    transform: translateX(-50%);
    width: 0; height: 0;
    border-left: 22px solid transparent;
    border-right: 22px solid transparent;
    border-bottom: 40px solid #ff3c00;
    filter: drop-shadow(0 0 6px rgba(255, 60, 0, 0.9));
    z-index: 10;
  }

  /* 按钮 */
  #spinbtn {
    margin-top: 32px;
    padding: 16px 56px;
    font-size: 1.4rem;
    background: #ffbf00;
    color: #333;
    font-weight: 700;
    border: none;
    border-radius: 16px;
    cursor: pointer;
    box-shadow: 0 6px 18px rgba(255, 191, 0, 0.7);
    transition: background-color 0.3s ease;
    user-select: none;
  }
  #spinbtn:hover:not(:disabled) {
    background: #ffd732;
  }
  #spinbtn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  /* 结果提示 */
  #result {
    margin-top: 40px;
    font-size: 1.6rem;
    font-weight: 700;
    min-height: 80px;
    text-align: center;
    text-shadow: 0 0 8px #ff8a00;
  }
  #confirmBtn {
    margin-top: 18px;
    padding: 14px 42px;
    font-size: 1.25rem;
    background: #28a745;
    color: white;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.8);
    display: none;
    user-select: none;
    transition: background-color 0.3s ease;
  }
  #confirmBtn:hover {
    background: #218838;
  }

  /* 底部闪电符号 */
  .footer-icon {
    margin-top: 52px;
    font-size: 72px;
    color: #ffe066;
    filter: drop-shadow(0 0 12px #ffe066);
    animation: flashLightning 1.8s infinite alternate;
    user-select: none;
  }
  @keyframes flashLightning {
    0% { opacity: 1; }
    100% { opacity: 0.5; }
  }
</style>
</head>
<body>

<!-- 语言选择 -->
<select id="langSelect" aria-label="Select language / 选择语言 / 言語を選択">
  <option value="pt" selected>Português (BR)</option>
  <option value="en">English</option>
  <option value="zh">中文</option>
  <option value="ja">日本語</option>
</select>

<h1 id="title">🎉 Roda da Sorte DeFi - Mineração</h1>
<p id="subtitle" class="subtitle">Gire a roleta e ganhe bônus exclusivos em USDT!</p>

<div class="wheel-container">
  <canvas id="wheelcanvas" width="480" height="480"></canvas>
  <div class="lights-ring"></div>
  <div id="pointer"></div>
</div>

<button id="spinbtn">GIRAR 🎁</button>

<div id="result"></div>
<button id="confirmBtn">Confirmar e Receber</button>

<div class="footer-icon">⚡</div>

<script>
  // 多语言数据
  const langData = {
    pt: {
      title: "🎉 Roda da Sorte DeFi - Mineração",
      subtitle: "Gire a roleta e ganhe bônus exclusivos em USDT!",
      spinBtn: "GIRAR 🎁",
      confirmBtn: "Confirmar e Receber",
      prizes: [
        "5 USDT",
        "10 USDT",
        "30 USDT",
        "Experiência 3 dias",
        "100 USDT",
        "Obrigado pela participação",
        "Mineração 7 dias",
        "1000 USDT"
      ],
      congrats: (prize) => `🎉 Parabéns! Você foi muito sortudo e ganhou <strong>${prize}</strong>!`,
      thanks: "🙏 Obrigado por participar! Tente novamente!",
      confirmRedirectText: "Clique em 'Confirmar e Receber' para continuar.",
      alreadySpinned: "⚠️ Você já participou e só pode girar uma vez!"
    },
    en: {
      title: "🎉 DeFi Lucky Wheel - Mining",
      subtitle: "Spin the wheel and win exclusive USDT bonuses!",
      spinBtn: "SPIN 🎁",
      confirmBtn: "Confirm & Claim",
      prizes: [
        "5 USDT",
        "10 USDT",
        "30 USDT",
        "3-day Trial",
        "100 USDT",
        "Thanks for participating",
        "7-day Mining",
        "1000 USDT"
      ],
      congrats: (prize) => `🎉 Congratulations! You are very lucky and won <strong>${prize}</strong>!`,
      thanks: "🙏 Thanks for participating! Try again!",
      confirmRedirectText: "Click 'Confirm & Claim' to continue.",
      alreadySpinned: "⚠️ You have already participated. Only one spin per user!"
    },
    zh: {
      title: "🎉 DeFi 幸运转盘 - 挖矿",
      subtitle: "旋转转盘，赢取独家USDT奖励！",
      spinBtn: "开始抽奖 🎁",
      confirmBtn: "确认领取",
      prizes: [
        "5 USDT",
        "10 USDT",
        "30 USDT",
        "体验3天",
        "100 USDT",
        "谢谢参与",
        "挖矿7天",
        "1000 USDT"
      ],
      congrats: (prize) => `🎉 恭喜你太幸运了，抽中了 <strong>${prize}</strong>！`,
      thanks: "🙏 谢谢参与！请再试一次！",
      confirmRedirectText: "点击“确认领取”继续。",
      alreadySpinned: "⚠️ 您已参与过，每个用户仅能抽奖一次！"
    },
    ja: {
      title: "🎉 DeFi ラッキーホイール - マイニング",
      subtitle: "ホイールを回してUSDTの限定ボーナスをゲット！",
      spinBtn: "スピン 🎁",
      confirmBtn: "確認して受け取る",
      prizes: [
        "5 USDT",
        "10 USDT",
        "30 USDT",
        "3日間体験",
        "100 USDT",
        "ご参加ありがとうございます",
        "7日間マイニング",
        "1000 USDT"
      ],
      congrats: (prize) => `🎉 おめでとうございます！とてもラッキーで <strong>${prize}</strong> を獲得しました！`,
      thanks: "🙏 ご参加ありがとうございます！もう一度お試しください！",
      confirmRedirectText: "'確認して受け取る' をクリックして続行してください。",
      alreadySpinned: "⚠️ すでに参加済みです。お一人様一回限りの抽選です！"
    }
  };

  let currentLang = 'pt';

  // DOM元素
  const titleEl = document.getElementById("title");
  const subtitleEl = document.getElementById("subtitle");
  const spinBtn = document.getElementById("spinbtn");
  const confirmBtn = document.getElementById("confirmBtn");
  const resultDiv = document.getElementById("result");
  const langSelect = document.getElementById("langSelect");
  const canvas = document.getElementById("wheelcanvas");
  const ctx = canvas.getContext("2d");

  const centerX = canvas.width / 2;
  const centerY = canvas.height / 2;
  const radius = 220;
  const segmentCount = 8;
  const segmentAngle = 2 * Math.PI / segmentCount;

  const colors = [
    "#ff6f61",
    "#f7b733",
    "#4caf50",
    "#2196f3",
    "#ff9800",
    "#9c27b0",
    "#00bcd4",
    "#e91e63"
  ];

  let spinning = false;
  let spinAngleStart = 0;
  let spinTime = 0;
  let spinTimeTotal = 0;

  // 根据语言绘制转盘
  function drawWheel() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // 转盘分块绘制
    for (let i = 0; i < segmentCount; i++) {
      let startAngle = segmentAngle * i;
      let endAngle = startAngle + segmentAngle;
      // 扇区颜色
      ctx.fillStyle = colors[i % colors.length];
      ctx.beginPath();
      ctx.moveTo(centerX, centerY);
      ctx.arc(centerX, centerY, radius, startAngle, endAngle, false);
      ctx.lineTo(centerX, centerY);
      ctx.fill();

      // 扇区边界线
      ctx.strokeStyle = "#222";
      ctx.lineWidth = 2;
      ctx.stroke();

      // 奖品文字
      ctx.save();
      ctx.fillStyle = "#fff";
      ctx.translate(centerX, centerY);
      ctx.rotate(startAngle + segmentAngle / 2);
      ctx.textAlign = "right";
      ctx.font = "bold 18px Rubik, sans-serif";
      ctx.fillText(langData[currentLang].prizes[i], radius - 15, 10);
      ctx.restore();
    }
  }

  // 旋转角度(度数转弧度)
  function rotateWheel(angle) {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.save();
    ctx.translate(centerX, centerY);
    ctx.rotate(angle);
    ctx.translate(-centerX, -centerY);
    drawWheel();
    ctx.restore();
  }

  // 转盘转动动画
  function easeOut(t, b, c, d) {
    // 缓动函数 - 减速效果
    t /= d;
    t--;
    return c * (t * t * t + 1) + b;
  }

  // 开始转盘
  function startSpin() {
    if (spinning) return;
    spinning = true;
    spinBtn.disabled = true;
    resultDiv.innerHTML = "";
    confirmBtn.style.display = "none";

    spinAngleStart = Math.random() * 10 + 20; // 初始速度（转几圈）
    spinTime = 0;
    spinTimeTotal = Math.random() * 3 + 4 * 1000; // 4-7秒转动时间（毫秒）

    requestAnimationFrame(rotate);
  }

  function rotate(timestamp) {
    if (!spinStartTime) spinStartTime = timestamp;
    const elapsed = timestamp - spinStartTime;
    spinTime = elapsed;

    if (spinTime >= spinTimeTotal) {
      stopRotate();
      spinStartTime = null;
      return;
    }

    let angle = easeOut(spinTime, 0, spinAngleStart * 2 * Math.PI, spinTimeTotal);
    rotateWheel(angle);
    requestAnimationFrame(rotate);
  }

  let spinStartTime = null;

  // 转盘停止后的处理
  function stopRotate() {
    spinning = false;

    // 计算落点奖品索引
    // 因为canvas逆时针为正角度，指针在顶部（0度）
    // 我们要找到角度对应奖品index
    const normalizedAngle = spinAngleStart * 2 * Math.PI % (2 * Math.PI);
    // 转盘逆时针转动，结果角度是旋转了多少，所以真实角度：
    // 真实指针角度 = 2PI - normalizedAngle
    const pointerAngle = (2 * Math.PI) - (spinAngleStart * 2 * Math.PI % (2 * Math.PI));

    // 计算奖品索引
    // 指针角度从0度开始，奖品0在0~segmentAngle范围，奖品1在segmentAngle~2*segmentAngle，以此类推
    let index = Math.floor(pointerAngle / segmentAngle) % segmentCount;

    // 显示中奖信息
    const prize = langData[currentLang].prizes[index];
    resultDiv.innerHTML = langData[currentLang].congrats(prize);
    confirmBtn.style.display = "inline-block";

    // 记录用户已抽奖
    localStorage.setItem("hasSpinned", "true");
  }

  // 语言切换更新文本
  function updateLanguage(lang) {
    currentLang = lang;
    const data = langData[lang];
    titleEl.textContent = data.title;
    subtitleEl.textContent = data.subtitle;
    spinBtn.textContent = data.spinBtn;
    confirmBtn.textContent = data.confirmBtn;

    // 重新绘制转盘
    drawWheel();

    // 已经参与过，显示提示并禁用按钮
    if (localStorage.getItem("hasSpinned") === "true") {
      spinBtn.disabled = true;
      resultDiv.textContent = data.alreadySpinned;
      confirmBtn.style.display = "none";
    } else {
      spinBtn.disabled = false;
      resultDiv.textContent = "";
      confirmBtn.style.display = "none";
    }
  }

  // 检查用户是否已转过
  function checkHasSpinned() {
    if (localStorage.getItem("hasSpinned") === "true") {
      spinBtn.disabled = true;
      resultDiv.textContent = langData[currentLang].alreadySpinned;
      confirmBtn.style.display = "none";
      return true;
    }
    return false;
  }

  // 绑定事件
  langSelect.addEventListener("change", e => {
    updateLanguage(e.target.value);
  });

  spinBtn.addEventListener("click", () => {
    if (checkHasSpinned()) return;
